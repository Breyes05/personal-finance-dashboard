generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        Int        @id @default(autoincrement())
  name      String?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  plaidItems PlaidItem[]
}

model PlaidItem {
  id          Int        @id @default(autoincrement())
  itemId      String     @unique
  accessToken String
  institution String?    // e.g., "Chase", "Wells Fargo"
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  userId Int
  user   User @relation(fields: [userId], references: [id])

  accounts     Account[]
}

// Bank accounts under each PlaidItem (e.g., checking, savings, credit card)
model Account {
  id          Int        @id @default(autoincrement())
  accountId   String     @unique // Plaid's account_id
  name        String
  type        String     // e.g., "depository", "credit"
  subtype     String?    // e.g., "checking", "savings"
  mask        String?    // last 2â€“4 digits of acct #
  balance     Float?     // current available balance
  createdAt   DateTime   @default(now())

  plaidItemId Int
  plaidItem   PlaidItem @relation(fields: [plaidItemId], references: [id])

  transactions Transaction[]
}

// Transactions belong to an account
model Transaction {
  id             Int      @id @default(autoincrement())
  plaidId        String   @unique   // Plaid's transaction_id
  amount         Float
  date           DateTime
  name           String
  category       String?
  createdAt      DateTime @default(now())

  accountId Int
  account   Account @relation(fields: [accountId], references: [id])
}